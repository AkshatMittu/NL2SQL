sql_complexity,sql_complexity_description,sql_task_type,sql_prompt,sql,sql_explanation,new_query,can_run,nl_query,sql_query
single join,"only one join (specify inner, outer, cross)",analytics and reporting,"What is the policy number, coverage start date, and name of the agent for all policies in the 'California' region?","SELECT policies.policy_number, policies.coverage_start_date, agents.name FROM policies INNER JOIN agents ON policies.agent_id = agents.agent_id WHERE policies.region = 'California';","Join the policies table with the agents table using the agent_id column to get the agent's name, then filter for policies in the 'California' region.","SELECT policies.policy_id, policies.policy_start_year, agents.agent_name FROM policies INNER JOIN agents ON policies.agent_id = agents.agent_id WHERE customers.state = 'California';",0,"What is the policy number, coverage start date, and agent name for all policies where the customer is from the 'California' region?",
basic SQL,basic SQL with a simple select statement,analytics and reporting,"What is the policy retention rate for policyholders from Japan, calculated as the percentage of policyholders who renewed their policies after the first year?",SELECT COUNT(*) * 100.0 / SUM(CASE WHEN FirstYear THEN 1 ELSE 0 END) AS PolicyRetentionRate FROM Policyholders WHERE Country = 'Japan';,"This query calculates the policy retention rate for policyholders from Japan by counting the number of policyholders who renewed their policies after the first year and dividing it by the total number of policyholders who had a first year, then multiplying by 100 to get a percentage.",SELECT COUNT(*) * 100.0 / SUM(CASE WHEN policy_start_year = '2023' THEN 1 ELSE 0 END) AS PolicyRetentionRate FROM policies WHERE 1=1;,0,"What is the overall policy retention rate, calculated as the percentage of policyholders who renewed their policies after the first year?",
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the minimum age for health insurance policyholders in Florida?,SELECT MIN(age) FROM policyholders WHERE state = 'FL' AND policy_type = 'Health';,"This query finds the minimum age for health insurance policyholders in Florida by selecting the age column from the policyholders table, filtering for Florida and Health policy_type, and applying the MIN function.",SELECT MIN(age) FROM customers WHERE state = 'FL';,0,What is the minimum age for customers in Florida?,select min(age) from customers where state = 'Florida'
single join,"only one join (specify inner, outer, cross)",analytics and reporting,What is the minimum claim amount for policyholders in Arizona?,SELECT MIN(claim_amount) FROM claims JOIN policyholders ON claims.policyholder_id = policyholders.id WHERE policyholders.state = 'Arizona';,"We are finding the minimum claim amount for policyholders in Arizona. We do this by joining the claims table with the policyholders table on the policyholder_id. We then filter the results to only include policyholders from Arizona using the WHERE clause. Finally, we calculate the minimum claim amount using the MIN function.",SELECT MIN(claim_amount) FROM claims JOIN customers ON claims.customer_id = customers.customer_id WHERE customers.state = 'Arizona';,0,What is the minimum claim amount from the claims of the customers in Arizona?,select min(c.claim_amount) from claims c join customers cu on c.customer_id = cu.customer_id where cu.state = 'Arizona'
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,"What is the average claim amount for policyholders from India, partitioned by policy type?","SELECT PolicyType, AVG(ClaimAmount) AS AvgClaimAmount FROM Claims WHERE Country = 'India' GROUP BY PolicyType;",This query calculates the average claim amount for each policy type by partitioning the data based on policy type and filtering for policyholders from India.,"SELECT policy_type, AVG(claim_amount) AS AvgClaimAmount FROM claims GROUP BY policy_type;",0,What is the average claim amount partitioned by policy type?,"SELECT policy_type, AVG(claim_amount) FROM claims JOIN policies USING(policy_id) GROUP BY policy_type"
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the total premium collected from policyholders in California who have Auto policies?,SELECT SUM(premium) FROM policyholders WHERE state = 'California' AND policy_type = 'Auto';,The SQL query calculates the total premium collected from policyholders in California who have Auto policies. It selects the sum of the 'premium' column in the 'policyholders' table where the 'state' column is 'California' and the 'policy_type' column is 'Auto'.,SELECT SUM(premium_amount) FROM policies WHERE customer_id IN (SELECT customer_id FROM customers WHERE state = 'California') AND policy_type = 'auto';,0,What is the total premium amount collected from customers in California who have Auto policies?,SELECT SUM(p.premium_amount) FROM customers c JOIN policies p ON c.customer_id = p.customer_id WHERE c.state = 'California' AND p.policy_type = 'auto'
single join,"only one join (specify inner, outer, cross)",analytics and reporting,What is the average claim amount for policyholders in 'rural' areas?,SELECT AVG(claim_amount) FROM claims c JOIN policyholder p ON c.policyholder_id = p.id WHERE p.address LIKE '%Rural%';,"The SQL query joins the 'claims' table with the 'policyholder' table based on the policyholder_id. It then filters the rows where the policyholder's address contains the word 'Rural'. Finally, it calculates the average claim amount for those policyholders.",SELECT AVG(claim_amount) FROM claims c JOIN customers p ON c.customer_id = p.customer_id WHERE p.city LIKE '%Rural%';,0,What is the average claim amount for customers in cities with 'Rural' in their name?,select avg(c.claim_amount) from claims c join customers cu on c.customer_id = cu.customer_id where lower(cu.city) like '%rural%'
set operations,"set operations such as UNION, INTERSECT, and EXCEPT",analytics and reporting,What are the names and birthdates of policyholders who have a policy in both the 'Auto' and 'Life' categories?,"SELECT Name, Birthdate FROM Policyholder WHERE PolicyType = 'Auto' INTERSECT SELECT Name, Birthdate FROM Policyholder WHERE PolicyType = 'Life';","First, we select the Name and Birthdate columns from the Policyholder table where the PolicyType is 'Auto'. Then, we use the INTERSECT operator to find the common records between this set and the set of records where the PolicyType is 'Life'. This returns the names and birthdates of policyholders who have policies in both the 'Auto' and 'Life' categories.",SELECT name FROM customers WHERE 'auto' = ANY(coverage_preferences) INTERSECT SELECT name FROM customers WHERE 'life' = ANY(coverage_preferences);,0,What are the names of policyholders who have a policy in both the 'Auto' and 'Life' categories?,"select c.name from customers c join policies p on c.customer_id = p.customer_id where p.policy_type in ('Auto', 'Life') group by c.customer_id, c.name having count(distinct p.policy_type) = 2"
multiple_joins,"two or more joins (specify inner, outer, cross)",analytics and reporting,"What are the names and policy numbers of policyholders who have never filed a claim, and what is the total number of such policyholders?","SELECT p.PolicyholderName, p.PolicyNumber FROM Policyholders p LEFT JOIN Claims c ON p.PolicyNumber = c.PolicyNumber WHERE c.ClaimID IS NULL; SELECT COUNT(*) FROM (SELECT p.PolicyholderName, p.PolicyNumber FROM Policyholders p LEFT JOIN Claims c ON p.PolicyNumber = c.PolicyNumber WHERE c.ClaimID IS NULL) AS t;","These queries join the Policyholders and Claims tables on the PolicyNumber field, filter for policyholders who have never filed a claim, and select their names and policy numbers. The second query calculates the total number of such policyholders.","SELECT c.customer_id, p.policy_id FROM customers c LEFT JOIN policies p ON c.customer_id = p.customer_id WHERE p.policy_id IS NULL; SELECT COUNT(*) FROM (SELECT c.customer_id, p.policy_id FROM customers c LEFT JOIN policies p ON c.customer_id = p.customer_id WHERE p.policy_id IS NULL) AS t;",0,"Which customers do not have a policy, and what is the total number of such customers?","SELECT DISTINCT customers.*, COUNT(*) OVER() AS total_customers FROM customers LEFT JOIN policies ON customers.customer_id = policies.customer_id WHERE policies.customer_id IS NULL"
subqueries,"subqueries, including correlated and nested subqueries",analytics and reporting,"What is the policy number, policy type, and coverage amount for the policy with the highest coverage amount?","SELECT policy_number, policy_type, coverage_amount FROM policies WHERE coverage_amount = (SELECT MAX(coverage_amount) FROM policies);","The SQL query selects the policy number, policy type, and coverage amount for the policy with the highest coverage amount. It uses a subquery to find the maximum coverage amount and then selects the corresponding policy number, policy type, and coverage amount from the policies table.","SELECT policy_id, policy_type, coverage_amount FROM policies WHERE coverage_amount = (SELECT MAX(coverage_amount) FROM policies);",0,"What are the policy number, type of policy, and coverage amount for the policy that has the maximum coverage amount?",
single join,"only one join (specify inner, outer, cross)",analytics and reporting,Identify customers with both 'Homeowners' and 'Car' policies in the United States.,SELECT Policy.CustomerID FROM Policy INNER JOIN Policy AS P2 ON Policy.CustomerID = P2.CustomerID WHERE Policy.PolicyType = 'Homeowners' AND P2.PolicyType = 'Car' AND Policy.Country = 'USA';,"Join Policy table to itself and filter rows with customers who have both 'Homeowners' and 'Car' policies in the United States, then retrieve CustomerID.",SELECT P1.customer_id FROM policies AS P1 INNER JOIN policies AS P2 ON P1.customer_id = P2.customer_id WHERE P1.policy_type = 'home' AND P2.policy_type = 'auto';,0,Find customers who have both 'Home' and 'Auto' policies.,
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the average age of policyholders in 'Texas'?,SELECT AVG(policyholders.age) AS avg_age FROM policyholders WHERE policyholders.state = 'Texas';,"The SQL query calculates the average age of policyholders in Texas. It does this by filtering the 'policyholders' table to only include rows with a 'state' value of 'Texas' using the WHERE clause. Then, it calculates the average age using the AVG function.",SELECT AVG(customers.age) AS avg_age FROM customers WHERE customers.state = 'Texas';,0,What is the average age of customers in 'Texas'?,select avg(age) from customers where state = 'Texas'
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the average number of policies per policyholder living in 'Georgia'?,SELECT AVG(num_policies) FROM policyholders WHERE state = 'GA';,"This SQL query calculates the average number of policies per policyholder living in 'Georgia'. It does this by using the AVG() function on the num_policies column, and filtering the policyholders table to only include rows where the state is 'GA'.",SELECT AVG(p.policy_duration_years) FROM policies p JOIN customers c ON p.customer_id = c.customer_id WHERE c.state = 'California';,0,What is the average policy duration in years for policyholders living in 'California'?,SELECT AVG(p.policy_duration_years) FROM policies p JOIN customers c ON p.customer_id = c.customer_id WHERE c.state = 'California'
basic SQL,basic SQL with a simple select statement,analytics and reporting,Display the earliest issue date for policies handled by 'BrokerSmith'.,SELECT MIN(IssueDate) FROM PoliciesBroker WHERE Broker = 'BrokerSmith';,"The SQL query selects the minimum issue date from the PoliciesBroker table, filtering for rows with a broker of 'BrokerSmith'.",SELECT MIN(policy_start_year) FROM policies WHERE agent_id IN (SELECT agent_id FROM agents WHERE agent_name LIKE '%Smith');,0,What is the earliest start year for policies managed by an agent with the name containing 'Smith'?,SELECT MIN(policy_start_year) FROM policies JOIN agents ON policies.policy_type = agents.policy_type WHERE LOWER(agent_name) LIKE '%smith%'
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,Calculate the average claims amount per policyholder,"SELECT policyholder_id, AVG(amount) as avg_claims FROM claims GROUP BY policyholder_id;",This query calculates the average amount of the amount column for each policyholder using the AVG function and groups the result by the policyholder_id column.,"SELECT customer_id, AVG(claim_amount) as avg_claims FROM claims GROUP BY customer_id;",0,Find the average claims amount for each policyholder,"select customer_id, avg(claim_amount) from claims join customers using(customer_id) group by customer_id"
subqueries,"subqueries, including correlated and nested subqueries",analytics and reporting,What is the average number of policies per underwriting department in 'Ontario'?,"SELECT AVG(policy_count) FROM (SELECT department, COUNT(*) AS policy_count FROM policies WHERE province = 'ON' GROUP BY department) AS dept_policies;",The SQL query calculates the average number of policies per underwriting department in 'Ontario' by using the AVG() function on a subquery that counts the number of policies per department in 'Ontario' with the GROUP BY clause. It filters the records based on the 'province' column.,SELECT AVG(policy_count) FROM (SELECT COUNT(*) AS policy_count FROM policies GROUP BY policy_type) AS dept_policies,0,What is the average number of policies per policy type?,"select avg(cnt) from (select policy_type, count(policy_id) as cnt from policies group by policy_type) as subquery"
basic SQL,basic SQL with a simple select statement,data manipulation,"Update the address of policyholder with policy_holder_id 222 in the 'policy_holder' table to '456 Elm St, Los Angeles, CA 90001'.","UPDATE policy_holder SET address = '456 Elm St, Los Angeles, CA 90001' WHERE policy_holder_id = 222;",This query filters the 'policy_holder' table based on the policy_holder_id and updates the address field of the corresponding record with the new address.,"UPDATE customers SET city = 'Los Angeles', state = 'California', zipcode = '90001' WHERE customer_id = 'CUST_000222';",0,"Update the city, state, and zipcode of customer with customer_id CUST_000222 in the 'customers' table to Los Angeles, CA 90001.",
single join,"only one join (specify inner, outer, cross)",analytics and reporting,What is the total number of policies by policyholder state?,"SELECT policyholder_state, COUNT(*) as total_policies FROM policies JOIN policyholder_state ON policies.policyholder_id = policyholder_state.policyholder_id GROUP BY policyholder_state;","This SQL query joins the policies and policyholder_state tables, groups the results by policyholder state, and then counts the number of policies per state.","SELECT state, COUNT(*) as total_policies FROM policies JOIN customers ON policies.customer_id = customers.customer_id GROUP BY state;",0,How many policies are there in each policyholder state?,
single join,"only one join (specify inner, outer, cross)",analytics and reporting,List policyholders with home insurance policies in Florida who are between 35 and 50 years old,"SELECT DISTINCT policyholder_age, policy_type FROM policyholders JOIN policies ON policyholders.policy_id = policies.policy_id WHERE policies.policy_state = 'FL' AND policyholder_age BETWEEN 35 AND 50;",This query retrieves unique policyholder information from the 'policyholders' table and policies information from the 'policies' table by joining them on the 'policy_id' column. The query filters the results to only include policyholders in Florida who are between 35 and 50 years old by checking the 'policy_state' and 'policyholder_age' columns.,"SELECT DISTINCT customers.age, policies.policy_type FROM customers JOIN policies ON customers.customer_id = policies.customer_id WHERE customers.state = 'Florida' AND customers.age BETWEEN 35 AND 50;",0,Show distinct ages and policy types of policyholders with insurance policies in Florida who are between 35 and 50 years old,"SELECT DISTINCT c.age, p.policy_type FROM customers c JOIN policies p ON c.customer_id = p.customer_id WHERE c.state = 'Florida' AND c.age BETWEEN 35 AND 50"
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the maximum claim amount paid to policyholders in 'Florida'?,SELECT MAX(claim_amount) FROM claims WHERE policyholder_state = 'Florida';,This query returns the maximum claim amount paid to policyholders in Florida by selecting the maximum claim_amount for all records where policyholder_state is 'Florida'.,SELECT MAX(claim_amount) FROM claims c JOIN customers cu ON c.customer_id = cu.customer_id WHERE cu.state = 'Florida';,0,What is the highest claim amount paid out to the policy holders in 'Florida'?,SELECT MAX(c.approved_amount) FROM claims c JOIN customers cu ON c.customer_id = cu.customer_id JOIN policies p ON c.policy_id = p.policy_id WHERE cu.state = 'Florida' AND c.claim_status = 'approved'
basic SQL,basic SQL with a simple select statement,data manipulation,Delete all policies from the state of 'TX'.,DELETE FROM policies WHERE state = 'TX';,The SQL query deletes all policies from the state of 'TX'. It uses the DELETE statement to remove rows from the policies table and the WHERE clause to specify the condition for the state.,DELETE FROM policies WHERE policy_id IN (SELECT policy_id FROM customers WHERE state = 'Texas');,0,Delete all policies belonging to customers in the state of 'Texas'.,
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,Calculate the total claims paid per month for the past 18 months?,"SELECT DATEPART(YEAR, ClaimDate) as Year, DATEPART(MONTH, ClaimDate) as Month, SUM(ClaimAmount) as TotalClaimsPaid FROM Claim WHERE ClaimDate >= DATEADD(MONTH, -18, GETDATE()) GROUP BY DATEPART(YEAR, ClaimDate), DATEPART(MONTH, ClaimDate) ORDER BY Year, Month;",1. Select Year and Month from ClaimDate and sum ClaimAmount.   2. Filter for claims within the past 18 months.   3. Group by Year and Month.   4. Order by Year and Month.,"SELECT SUBSTR(claim_date, 1, 4) as Year, SUBSTR(claim_date, 6, 2) as Month, SUM(approved_amount) as TotalClaimsPaid FROM claims WHERE claim_date >= DATE_SUB(CURDATE(), INTERVAL 18 MONTH) GROUP BY Year, Month ORDER BY Year, Month;",0,What is the total claim amount approved per month for the last 18 months?,
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,Display the policy type and average claim amount for policies with more than one claim in the state of California,"SELECT policy_type, AVG(claim_amount) FROM claims WHERE policy_state = 'CA' GROUP BY policy_type HAVING COUNT(policy_id) > 1;",This query retrieves policy type and claim amount information from the 'claims' table and filters the results to only include policies in the state of California by checking the 'policy_state' column. The query then groups the results by policy type and filters the results to only include policies with more than one claim by using the HAVING clause and COUNT() function. The query then calculates the average claim amount for each policy type by using the AVG() function and the GROUP BY clause.,"SELECT policy_type, AVG(claim_amount) FROM claims JOIN policies ON claims.policy_id = policies.policy_id WHERE policies.policy_status = 'active' GROUP BY policy_type HAVING COUNT(DISTINCT policy_id) > 1;",0,Display the policy type and average claim amount for active policies with more than one claim,"SELECT policies.policy_type, AVG(claims.claim_amount) FROM policies JOIN claims ON policies.policy_id = claims.policy_id WHERE policies.policy_status = 'active' GROUP BY claims.policy_id,policies.policy_type HAVING COUNT(claims.policy_id) > 1"
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,Show the maximum claim amount for policyholders in each state,"SELECT state, MAX(claim_amount) FROM claims GROUP BY state;",This query groups the results by state and calculates the maximum (MAX) of the claim_amount column for each group,"SELECT c.state, MAX(cl.claim_amount) FROM claims cl JOIN customers c ON cl.customer_id = c.customer_id GROUP BY c.state;",0,What is the highest claim amount for policyholders in each state?,"SELECT c.state, MAX(cl.claim_amount) FROM customers c JOIN policies p ON c.customer_id = p.customer_id JOIN claims cl ON p.policy_id = cl.policy_id GROUP BY c.state"
basic SQL,basic SQL with a simple select statement,data manipulation,Delete all claims with a claim amount greater than 5000.,DELETE FROM claims WHERE claim_amount > 5000;,This query deletes all claims with a claim amount greater than 5000 from the claims table.,DELETE FROM claims WHERE claim_amount > 5000 AND policy_id IN (SELECT policy_id FROM policies) AND customer_id IN (SELECT customer_id FROM customers);,0,Delete all claims with a claim amount greater than 5000 where the policy ID exists in the policies table and the customer ID exists in the customers table.,
basic SQL,basic SQL with a simple select statement,data definition,Alter the 'claims' table to add a constraint that the 'claim_amount' should be non-negative,ALTER TABLE claims ADD CONSTRAINT non_negative_claim CHECK (claim_amount >= 0);,The 'claims' table is altered to add a constraint that the 'claim_amount' column should be non-negative.,ALTER TABLE claims ADD CONSTRAINT non_negative_claim CHECK (claim_amount >= 0);,1,Alter the 'claims' table to add a constraint called 'non_negative_claim' that ensures the 'claim_amount' is non-negative,
single join,"only one join (specify inner, outer, cross)",analytics and reporting,Calculate the total claims amount for each gender.,"SELECT gender, SUM(claim_amount) FROM claims JOIN policyholders ON claims.policyholder_id = policyholders.policyholder_id GROUP BY gender;",This SQL query calculates the total claims amount for each gender by joining the 'claims' table with the 'policyholders' table on the 'policyholder_id' column. The query then groups the results by the 'gender' column and calculates the sum of the 'claim_amount' column for each group.,"SELECT c.gender, SUM(cl.claim_amount) FROM claims cl JOIN customers c ON cl.customer_id = c.customer_id GROUP BY c.gender;",0,What is the sum of claim amounts for each gender?,
single join,"only one join (specify inner, outer, cross)",analytics and reporting,Find policyholders who have not filed a claim in the past 12 months,"SELECT policyholder_id, policyholder_name FROM policyholders LEFT JOIN claims_info USING (policyholder_id) WHERE claim_date IS NULL OR claim_date < (CURRENT_DATE - INTERVAL '12 months')",This SQL query finds policyholders who have not filed a claim in the past 12 months by performing a left join between the 'policyholders' table and the 'claims_info' table on the 'policyholder_id' column. It then filters the results to only include policyholders who have not filed a claim in the past 12 months by checking if the 'claim_date' column is null or less than 12 months before the current date.,"SELECT c.customer_id, c.name FROM customers c LEFT JOIN claims cl ON c.customer_id = cl.customer_id WHERE cl.claim_date IS NULL OR cl.claim_date < (CURRENT_DATE - INTERVAL '12 months')",0,List policyholders who have not filed a claim in the last 12 months,
basic SQL,basic SQL with a simple select statement,analytics and reporting,List all policies that will expire in the next 30 days.,"SELECT PolicyID, ExpirationDate FROM Policies WHERE ExpirationDate BETWEEN DATE_ADD(CURRENT_DATE(), INTERVAL 1 DAY) AND DATE_ADD(CURRENT_DATE(), INTERVAL 30 DAY);","This SQL query lists all policies that will expire in the next 30 days by filtering the results to only include policies with expiration dates between 1 day and 30 days from the current date using the BETWEEN, DATE_ADD and CURRENT_DATE functions. It returns the PolicyID and ExpirationDate columns.","SELECT policy_id, policy_end_year FROM policies WHERE policy_end_year BETWEEN YEAR(DATE_ADD(CURRENT_DATE(), INTERVAL 1 DAY)) AND YEAR(DATE_ADD(CURRENT_DATE(), INTERVAL 30 DAY));",0,List all policy IDs and their expiration years that will expire in the next 30 days.,
single join,"only one join (specify inner, outer, cross)",analytics and reporting,Who are the top 3 underwriters with the highest claim amount in the Midwest region?,"SELECT Underwriters.UnderwriterID, Underwriters.Region, SUM(Claims.Amount) AS TotalClaimAmount FROM Claims INNER JOIN Underwriters ON Claims.UnderwriterID = Underwriters.UnderwriterID WHERE Underwriters.Region = 'Midwest' GROUP BY Underwriters.UnderwriterID, Underwriters.Region ORDER BY TotalClaimAmount DESC LIMIT 3;","This SQL query lists the top 3 underwriters with the highest claim amount in the Midwest region by performing an inner join between the Claims and Underwriters tables on the UnderwriterID column. It then filters the results to only include underwriters from the Midwest region, calculates the total claim amount for each underwriter using the SUM function, and orders the results in descending order by total claim amount. It returns the UnderwriterID, Region, and total claim amount columns.","SELECT agents.agent_id, agents.agency_name, SUM(claims.claim_amount) AS TotalClaimAmount FROM claims INNER JOIN agents ON claims.agent_id = agents.agent_id WHERE agents.agency_name = 'Midwest Agency' GROUP BY agents.agent_id, agents.agency_name ORDER BY TotalClaimAmount DESC LIMIT 3;",0,Who are the top 3 agents with the highest claim amount in Midwest Agency?,"SELECT agents.agent_id, agents.agent_name, SUM(claims.claim_amount) AS total_claim_amount FROM agents JOIN (claims JOIN policies ON claims.policy_id = policies.policy_id) ON agents.agent_id = claims.customer_id WHERE agents.agency_name = 'Midwest Agency' GROUP BY agents.agent_id, agents.agent_name ORDER BY total_claim_amount DESC LIMIT 3"
basic SQL,basic SQL with a simple select statement,data manipulation,Insert sample data into 'claims' table,"INSERT INTO claims (claim_id, policyholder_id, claim_amount, claim_date) VALUES (1, 1, 500, '2022-01-01'), (2, 2, 300, '2022-02-15'), (3, 3, 700, '2022-03-05');",Sample data is inserted into the 'claims' table for demonstration purposes.,"INSERT INTO claims (claim_id, policy_id, customer_id, claim_amount, claim_date) VALUES ('CLM_000001', 'POL_000001', 'CUST_000001', 500, '2022-01-01'), ('CLM_000002', 'POL_000002', 'CUST_000002', 300, '2022-02-15'), ('CLM_000003', 'POL_000003', 'CUST_000003', 700, '2022-03-05');",0,"Insert sample data with claim_id 'CLM_000001', 'CLM_000002', 'CLM_000003' into 'claims' table",
single join,"only one join (specify inner, outer, cross)",analytics and reporting,List policyholders who have never filed a claim.,"SELECT DISTINCT p.PolicyholderID, p.Name, p.DOB, p.Product FROM Policyholder p LEFT JOIN Claim c ON p.PolicyholderID = c.PolicyholderID WHERE c.ClaimID IS NULL;","This query uses a LEFT JOIN to join the Policyholder and Claim tables on the PolicyholderID column. The LEFT JOIN returns all records from the Policyholder table and any matching records from the Claim table. The WHERE clause filters the result set to only include records where the ClaimID column is NULL, indicating that there are no matching records in the Claim table. The DISTINCT keyword is used to ensure that each policyholder is only listed once.","SELECT DISTINCT c.customer_id, cu.name FROM customers cu LEFT JOIN claims c ON cu.customer_id = c.customer_id WHERE c.claim_id IS NULL;",0,List customers who have never made a claim.,SELECT DISTINCT c.* FROM customers c LEFT JOIN claims cl ON c.customer_id = cl.customer_id WHERE cl.claim_id IS NULL
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,"Identify the top 3 policy types with the highest average claim amount, ordered by the average claim amount in descending order.","SELECT PolicyType, AVG(ClaimAmount) as AvgClaimAmount FROM Claims GROUP BY PolicyType ORDER BY AvgClaimAmount DESC LIMIT 3;",This query calculates the average claim amount for each policy type using the AVG and GROUP BY functions. The ORDER BY and LIMIT clauses are used to only show the top 3 policy types with the highest average claim amount.,"SELECT policy_type, AVG(claim_amount) as AvgClaimAmount FROM claims GROUP BY policy_type ORDER BY AvgClaimAmount DESC LIMIT 3;",0,"What are the top 3 policy types with the highest average claim amount, listed in descending order of average claim amount?","SELECT p.policy_type, AVG(c.claim_amount) AS avg_claim_amount FROM claims c JOIN policies p ON c.policy_id = p.policy_id GROUP BY p.policy_type ORDER BY avg_claim_amount DESC LIMIT 3"
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the count of claims for policy number 1004?,SELECT COUNT(*) FROM claims WHERE policy_id = 1004;,"This SQL query counts the number of claims for policy number 1004. It does this by using the COUNT() function on all rows (*), filtering the rows with the WHERE clause to only consider the claims associated with policy number 1004.",SELECT COUNT(*) FROM claims WHERE policy_id = 'POL_001004';,0,What is the count of claims for policy number POL_001004?,select count(c.claim_id) from claims c join policies p on c.policy_id = p.policy_id where c.policy_id = 'POL_001004'
multiple_joins,"two or more joins (specify inner, outer, cross)",analytics and reporting,Retrieve the total number of policies and claims for each risk assessment model.,"SELECT risk_assessment_models.model_name, COUNT(policies.policy_id) AS total_policies, COUNT(claims.claim_id) AS total_claims FROM risk_assessment_models LEFT JOIN policies ON risk_assessment_models.risk_assessment_model_id = policies.risk_assessment_model_id LEFT JOIN claims ON policies.policy_id = claims.policy_id GROUP BY risk_assessment_models.risk_assessment_model_id;","This query performs a left join between the risk_assessment_models, policies, and claims tables, groups the result by risk_assessment_model_id, and retrieves the total number of policies and claims for each risk assessment model.","SELECT 'N/A' AS model_name, COUNT(policies.policy_id) AS total_policies, COUNT(claims.claim_id) AS total_claims FROM policies LEFT JOIN claims ON policies.policy_id = claims.policy_id GROUP BY 'N/A';",0,Get the total count of policies and claims for policies that do not have an associated risk assessment model.,select (select count(*) from policies where policy_risk_level is null or policy_risk_level = '') + (select count(*) from claims where policy_id in (select policy_id from policies where policy_risk_level is null or policy_risk_level = '')) as total_count
multiple_joins,"two or more joins (specify inner, outer, cross)",analytics and reporting,"List all policy types that have no claims, ordered by policy type.",SELECT PolicyTypes.PolicyType FROM PolicyTypes LEFT JOIN Policyholders ON PolicyTypes.PolicyTypeID = Policyholders.PolicyTypeID LEFT JOIN Claims ON Policyholders.PolicyholderID = Claims.PolicyholderID WHERE Claims.ClaimID IS NULL GROUP BY PolicyTypes.PolicyType ORDER BY PolicyTypes.PolicyType;,"This SQL query lists all policy types that have no claims, ordered by policy type. It does this by performing a left join between the PolicyTypes, Policyholders, and Claims tables on the PolicyTypeID and PolicyholderID fields, filtering for records where the ClaimID field in the Claims table is NULL, grouping the results by the PolicyType field in the PolicyTypes table, and finally sorting the results by the PolicyType field in the PolicyTypes table in ascending order.",SELECT p.policy_type FROM policies p LEFT JOIN customers c ON p.customer_id = c.customer_id LEFT JOIN claims cl ON c.customer_id = cl.customer_id WHERE cl.claim_id IS NULL GROUP BY p.policy_type ORDER BY p.policy_type;,0,"List all policy types that have no associated claims, ordered by policy type.",
single join,"only one join (specify inner, outer, cross)",analytics and reporting,What is the average claim amount for policyholders in the Southwest region?,SELECT AVG(Claims.Amount) FROM Claims INNER JOIN Policyholders ON Claims.PolicyholderID = Policyholders.PolicyholderID WHERE Policyholders.Region = 'Southwest';,This SQL query calculates the average claim amount for policyholders in the Southwest region by performing an inner join between the Policyholders and Claims tables on the PolicyholderID column. It then filters the results to only include policyholders from the Southwest region and calculates the average claim amount using the AVG function.,"SELECT AVG(claim_amount) FROM claims INNER JOIN customers ON claims.customer_id = customers.customer_id WHERE customers.state IN ('Texas', 'California', 'Arizona', 'New Mexico', 'Nevada', 'Utah', 'Colorado');",0,"What is the average claim amount for customers in the states of Texas, California, Arizona, New Mexico, Nevada, Utah, and Colorado?",
single join,"only one join (specify inner, outer, cross)",analytics and reporting,What is the total claim amount for home insurance policies in the 'East' region?,SELECT SUM(HomePolicies.ClaimAmount) FROM HomePolicies INNER JOIN Policyholders ON HomePolicies.PolicyID = Policyholders.PolicyholderID WHERE Policyholders.Region = 'East';,"The SQL query calculates the total claim amount for home insurance policies in the 'East' region by performing an INNER JOIN between the 'HomePolicies' and 'Policyholders' tables, based on the matching 'PolicyID', and using the SUM function on the 'ClaimAmount' column, filtered by the 'Region' column with the value 'East'.","SELECT SUM(claim_amount) FROM claims INNER JOIN policies ON claims.policy_id = policies.policy_id INNER JOIN customers ON policies.customer_id = customers.customer_id WHERE customers.city IN ('New York', 'Miami');",0,What is the total claim amount for all insurance policies in the cities of New York and Miami?,
basic SQL,basic SQL with a simple select statement,data retrieval,"Show Underwriting data for policies with an 'Auto' type, a premium less than or equal to $1000, and a PolicyholderID greater than 2.",SELECT * FROM Underwriting WHERE PolicyType = 'Auto' AND Premium <= 1000 AND PolicyholderID > 2;,"We select all columns from the Underwriting table where the PolicyType is 'Auto', the Premium is less than or equal to $1000, and the PolicyholderID is greater than 2. This returns the underwriting data for policies with an 'Auto' type, a premium less than or equal to $1000, and a PolicyholderID greater than 2.",SELECT * FROM policies WHERE policy_type = 'auto' AND premium_amount <= 1000 AND customer_id > 'CUST_000002';,0,"Show Policy data for policies with an 'auto' type, a premium amount less than or equal to $1000, and a CustomerID greater than 'CUST_000002'.","SELECT policies.policy_id, policies.customer_id, policies.policy_type, policies.premium_amount, policies.coverage_amount, policies.policy_duration_years, policies.policy_start_year, policies.policy_end_year, policies.policy_risk_level, policies.policy_status, customers.customer_id, customers.name, customers.phone, customers.city, customers.state, customers.zipcode, customers.age, customers.gender, customers.marital_status, customers.dependents, customers.education_level, customers.occupation, customers.employment_status, customers.annual_income, customers.credit_score, customers.existing_loans, customers.avg_monthly_expense, customers.vehicle_owner, customers.vehicle_type, customers.budget_per_month, customers.customer_tenure_years, customers.coverage_preferences, customers.risk_tolerance, customers.interest_tags FROM policies JOIN customers ON policies.customer_id = customers.customer_id WHERE policies.policy_type = 'auto' AND policies.premium_amount <= 1000 AND policies.customer_id > 'CUST_000002'"
single join,"only one join (specify inner, outer, cross)",analytics and reporting,How many claims were made by policyholders from New York?,SELECT COUNT(*) as ny_claims FROM claims JOIN policyholders ON claims.policyholder_id = policyholders.policyholder_id WHERE policyholder_state = 'New York';,"This SQL query joins the policyholders and claims tables, filters the results to only include claims made by policyholders from New York, and then counts the number of claims.",SELECT COUNT(*) as ny_claims FROM claims JOIN customers ON claims.customer_id = customers.customer_id WHERE state = 'New York';,0,How many claims were joined with customers from New York?,SELECT COUNT(DISTINCT claims.claim_id) FROM claims JOIN customers ON claims.customer_id = customers.customer_id WHERE customers.state = 'New York';
basic SQL,basic SQL with a simple select statement,data retrieval,Write a SQL query to retrieve the policyholder information from the view you created,SELECT * FROM policyholder_info;,"The SQL query selects all columns and rows from the ""policyholder_info"" view.",SELECT * FROM customers;,0,Retrieve all information of the customers.,select * from customers
basic SQL,basic SQL with a simple select statement,analytics and reporting,Calculate the total claim amount paid to policyholders in 'California' and 'Colorado' in June 2020.,"SELECT SUM(claim_amount) FROM claims WHERE policyholder_state IN ('California', 'Colorado') AND claim_date BETWEEN '2020-06-01' AND '2020-06-30';",This query calculates the total claim amount paid to policyholders in California and Colorado in June 2020 by summing the claim_amount for all records where policyholder_state is either 'California' or 'Colorado' and the claim_date falls between '2020-06-01' and '2020-06-30'.,"SELECT SUM(claim_amount) FROM claims WHERE customer_id IN (SELECT customer_id FROM customers WHERE state IN ('California', 'Colorado')) AND claim_date BETWEEN '2020-06-01' AND '2020-06-30';",0,What is the total claim amount paid to policyholders in 'California' and 'Colorado' in June 2020?,"SELECT SUM(c.approved_amount) FROM claims c JOIN customers cu ON c.customer_id = cu.customer_id WHERE cu.state IN ('California', 'Colorado') AND c.claim_date BETWEEN '2020-06-01' AND '2020-06-30' AND c.claim_status = 'approved'"
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the name and phone number of policyholders in New York?,"SELECT policyholder_name, phone_number FROM policies WHERE state = 'New York';",This query filters the policies table to only show records where the state column is equal to 'New York'. The result set includes the policyholder_name and phone_number columns.,"SELECT customers.name AS policyholder_name, customers.phone AS phone_number FROM policies JOIN customers ON policies.customer_id = customers.customer_id WHERE customers.state = 'New York';",0,What are the names and phone numbers of policyholders who reside in New York?,"SELECT c.name, c.phone FROM customers c JOIN policies p ON c.customer_id = p.customer_id WHERE c.city = 'New York'"
single join,"only one join (specify inner, outer, cross)",analytics and reporting,What is the total claim amount for auto insurance policies in the 'South' region?,SELECT SUM(AutoPolicies.ClaimAmount) FROM AutoPolicies INNER JOIN Policyholders ON AutoPolicies.PolicyID = Policyholders.PolicyholderID WHERE Policyholders.Region = 'South';,"The SQL query calculates the total claim amount for auto insurance policies in the 'South' region by performing an INNER JOIN between the 'AutoPolicies' and 'Policyholders' tables, based on the matching 'PolicyID', and using the SUM function on the 'ClaimAmount' column, filtered by the 'Region' column with the value 'South'.","SELECT SUM(claim_amount) FROM claims INNER JOIN customers ON claims.customer_id = customers.customer_id WHERE customers.state IN ('Texas', 'Florida');",0,What is the total claim amount for auto insurance policies in the states of 'Texas' and 'Florida'?,
window functions,"window functions (e.g., ROW_NUMBER, LEAD, LAG, RANk, NTILE, PERCENT_RANK, etc.) with partitioning and ordering",analytics and reporting,What is the maximum claim amount for policies sold in California?,SELECT MAX(ClaimAmount) OVER (PARTITION BY SaleState) as MaxClaimAmount FROM Claims WHERE SaleState = 'California';,This query calculates the maximum claim amount for policies sold in California by partitioning the data using the SaleState column and calculating the maximum claim amount within the California partition.,SELECT MAX(claim_amount) OVER (PARTITION BY state) as MaxClaimAmount FROM claims WHERE state = 'California';,0,What is the maximum claim amount for each policy sold in California?,"SELECT policies.policy_id, MAX(claims.claim_amount) AS max_claim_amount FROM claims JOIN policies ON claims.policy_id = policies.policy_id JOIN customers ON policies.customer_id = customers.customer_id WHERE customers.state = 'California' GROUP BY policies.policy_id"
single join,"only one join (specify inner, outer, cross)",analytics and reporting,Which claims were processed by adjusters with the last name 'Garcia' or 'Kim'?,"SELECT claim_id FROM claim JOIN adjuster ON claim.adjuster_id = adjuster.adjuster_id WHERE last_name IN ('Garcia', 'Kim');",This query retrieves claim IDs by joining the claim and adjuster tables on adjuster ID and filtering for adjusters with the last name 'Garcia' or 'Kim'.,SELECT claim_id FROM claims WHERE customer_id IN (SELECT customer_id FROM customers WHERE name LIKE '%Garcia%' OR name LIKE '%Kim%');,0,Which claim ids were processed by customers with the last name 'Garcia' or 'Kim'?,SELECT claims.claim_id FROM customers JOIN claims ON customers.customer_id = claims.customer_id WHERE customers.name LIKE '% Garcia' OR customers.name LIKE '% Kim'
basic SQL,basic SQL with a simple select statement,analytics and reporting,What is the total claim amount for policies in 'CA'?,SELECT SUM(total_claims) FROM policyholders WHERE state = 'CA';,This query calculates the total claim amount for policies in the state of 'CA'. It filters the records in the 'policyholders' table by the 'state' field and then calculates the sum of the 'total_claims' field using the SUM function.,SELECT SUM(claim_amount) FROM claims WHERE customer_id IN (SELECT customer_id FROM customers WHERE state = 'California');,0,What is the total claim amount for customers in 'California'?,select sum(c.claim_amount) from claims c join customers cu on c.customer_id = cu.customer_id where cu.state = 'california'
basic SQL,basic SQL with a simple select statement,analytics and reporting,How many home insurance policies were sold in New York in the last year?,SELECT COUNT(*) FROM policies WHERE state = 'NY' AND policy_type = 'Home' AND YEAR(sale_date) = 2021;,"This query counts the number of home insurance policies sold in New York in the last year by selecting the entire row set and applying the COUNT function, filtering for New York and Home policy_type, and checking if the sale_date is within the last year (2021 in this case) using the YEAR function.",SELECT COUNT(*) FROM policies WHERE policy_type = 'home' AND policy_start_year = 2021;,0,How many home insurance policies were sold in the year 2021?,select count(distinct policy_id) from policies where policy_type = 'home' and policy_start_year = 2021
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,Find the policy type with the highest claim amount.,"SELECT PolicyType, MAX(ClaimAmount) FROM HighestClaim GROUP BY PolicyType;","The SQL query calculates the maximum claim amount for each policy type in the HighestClaim table, grouped by policy type.","SELECT policy_type, MAX(claim_amount) FROM claims GROUP BY policy_type;",0,Find the maximum claim amount for each policy type.,"SELECT p.policy_type, MAX(c.claim_amount) FROM claims c JOIN policies p ON c.policy_id = p.policy_id GROUP BY p.policy_type"
aggregation,"aggregation functions (COUNT, SUM, AVG, MIN, MAX, etc.), and HAVING clause",analytics and reporting,What is the total number of policies and claims for each type of vehicle insurance in the state of California?,"SELECT Type, SUM(Policy_Count) AS Total_Policies, SUM(Claim_Count) AS Total_Claims FROM Vehicle_Insurance WHERE State = 'California' GROUP BY Type;","This SQL query calculates the total number of policies and claims for each type of vehicle insurance in California by summing the Policy_Count and Claim_Count columns, grouped by the Type column.","SELECT p.policy_type AS Type, COUNT(p.policy_id) AS Total_Policies, COUNT(c.claim_id) AS Total_Claims FROM policies p LEFT JOIN claims c ON p.policy_id = c.policy_id JOIN customers cust ON p.customer_id = cust.customer_id WHERE cust.state = 'California' AND p.policy_type IN ('auto') GROUP BY p.policy_type;",0,What is the total number of auto insurance policies and claims in the state of California?,"select count(distinct p.policy_id) as total_auto_policies, count(distinct c.claim_id) as total_auto_claims from policies p left join claims c on p.policy_id = c.policy_id join customers cu on p.customer_id = cu.customer_id where cu.state = 'California' and p.policy_type = 'auto'"
